# ะะฐะฑะพัะฐัะพัะฝะฐั ัะฐะฑะพัะฐ โ2: ะะตะฐะบัะธะฒะฝะพะต ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะต ะธ ะฒะตะฑ-ะบะปะธะตะฝัั

## ะะฐัะธะฐะฝั 5 โ ะะพะธัะบ ะบะฝะธะณ ะฟะพ ะฐะฒัะพัั

ะัะพะตะบั ัะพััะพะธั ะธะท ะดะฒัั Spring Boot ัะตัะฒะธัะพะฒ:
- **Service A** (ะฟะพัั 8080) - ะบะปะธะตะฝั, ะพัะฟัะฐะฒะปัััะธะน ะทะฐะฟัะพัั ัะตัะตะท WebClient
- **Service B** (ะฟะพัั 8081) - ัะตัะฒะตั, ะพะฑัะฐะฑะฐััะฒะฐััะธะน ะทะฐะฟัะพัั ะธ ะฒะพะทะฒัะฐัะฐััะธะน ะดะฐะฝะฝัะต ะฒ ัะตะฐะบัะธะฒะฝะพะผ ัะพัะผะฐัะต

## ะขัะตะฑะพะฒะฐะฝะธั

- Java 21+
- Maven 3.6+

## ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
search_books_by_author/
โโโ service-a/          # ะะปะธะตะฝััะบะธะน ัะตัะฒะธั
โ   โโโ src/
โ   โ   โโโ main/
โ   โ       โโโ java/
โ   โ       โ   โโโ com/bookclient/
โ   โ       โ       โโโ ServiceAApplication.java
โ   โ       โ       โโโ config/
โ   โ       โ       โ   โโโ WebClientConfig.java
โ   โ       โ       โโโ controller/
โ   โ       โ       โ   โโโ BookClientController.java
โ   โ       โ       โโโ filter/
โ   โ       โ       โ   โโโ LoggingWebFilter.java
โ   โ       โ       โโโ model/
โ   โ       โ       โ   โโโ Book.java
โ   โ       โ       โโโ service/
โ   โ       โ           โโโ BookClientService.java
โ   โ       โโโ resources/
โ   โ           โโโ application.yml
โ   โโโ pom.xml
โ
โโโ service-b/          # ะกะตัะฒะตัะฝัะน ัะตัะฒะธั
    โโโ src/
    โ   โโโ main/
    โ       โโโ java/
    โ       โ   โโโ com/bookservice/
    โ       โ       โโโ ServiceBApplication.java
    โ       โ       โโโ controller/
    โ       โ       โ   โโโ BookController.java
    โ       โ       โโโ filter/
    โ       โ       โ   โโโ LoggingWebFilter.java
    โ       โ       โโโ model/
    โ       โ       โ   โโโ Book.java
    โ       โ       โโโ service/
    โ       โ           โโโ BookService.java
    โ       โโโ resources/
    โ           โโโ application.yml
    โโโ pom.xml
```

## ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั

### 1. ะะฐะฟััะบ Service B (ัะตัะฒะตั)

```bash
cd service-b
mvn clean install
mvn spring-boot:run
```

Service B ะฑัะดะตั ะดะพัััะฟะตะฝ ะฝะฐ `http://localhost:8081`

### 2. ะะฐะฟััะบ Service A (ะบะปะธะตะฝั)

ะ ะดััะณะพะผ ัะตัะผะธะฝะฐะปะต:

```bash
cd service-a
mvn clean install
mvn spring-boot:run
```

Service A ะฑัะดะตั ะดะพัััะฟะตะฝ ะฝะฐ `http://localhost:8080`

## API Endpoints

### Service A (ะะปะธะตะฝั)

#### 1. ะะพะธัะบ ะบะฝะธะณ ะฟะพ ะฐะฒัะพัั
```bash
GET http://localhost:8080/api/client/search?author=ะขะพะปััะพะน
```

ะัะธะผะตั:
```bash
curl "http://localhost:8080/api/client/search?author=ะขะพะปััะพะน"
```

#### 2. ะะพะดััะตั ะบะฝะธะณ ะฐะฒัะพัะฐ
```bash
GET http://localhost:8080/api/client/count?author=ะััะบะธะฝ
```

ะัะธะผะตั:
```bash
curl "http://localhost:8080/api/client/count?author=ะััะบะธะฝ"
```

#### 3. ะะพะธัะบ ะบะฝะธะณ ะฟะพ ะฐะฒัะพัั ะธ ะณะพะดั
```bash
GET http://localhost:8080/api/client/search-by-year?author=ะะพััะพะตะฒัะบะธะน&minYear=1850
```

ะัะธะผะตั:
```bash
curl "http://localhost:8080/api/client/search-by-year?author=ะะพััะพะตะฒัะบะธะน&minYear=1850"
```

### Service B (ะกะตัะฒะตั)

#### ะะพะธัะบ ะบะฝะธะณ ะฟะพ ะฐะฒัะพัั
```bash
GET http://localhost:8081/api/books/search?author=ะงะตัะพะฒ
```

ะัะธะผะตั:
```bash
curl "http://localhost:8081/api/books/search?author=ะงะตัะพะฒ"
```

## ะัะพะฑะตะฝะฝะพััะธ ะฝะตะพะฟัะธะผะฐะปัะฝะพะณะพ ะบะพะดะฐ

### ๐ด ะะตะพะฟัะธะผะฐะปัะฝะฐั ะปะพะณะธะบะฐ ะฒ Service B (BookService.java)

#### 1. **ะะตะฝะตัะฐัะธั ะฑะพะปััะพะน ะบะพะปะปะตะบัะธะธ ะฟัะธ ะบะฐะถะดะพะผ ะทะฐะฟัะพัะต**
```java
List<Book> allBooks = generateLargeBookCollection();
```
- ะัะธ **ะบะฐะถะดะพะผ ะทะฐะฟัะพัะต** ัะพะทะดะฐะตััั ะบะพะปะปะตะบัะธั ะธะท **200,000 ะบะฝะธะณ**
- ะะฝะธะณะธ ะณะตะฝะตัะธัััััั ะทะฐะฝะพะฒะพ, ะฐ ะฝะต ะบััะธัััััั
- ะะฐะฝะธะผะฐะตั ะผะฝะพะณะพ ะฟะฐะผััะธ ะธ ะฒัะตะผะตะฝะธ ะฝะฐ ัะพะทะดะฐะฝะธะต ะพะฑัะตะบัะพะฒ

#### 2. **ะกะปะพะถะฝัะน regex ั backtracking**
```java
String complexRegex = ".*(" + 
    authorQuery.chars()
        .mapToObj(c -> "[" + Character.toLowerCase((char)c) + 
                      Character.toUpperCase((char)c) + "]")
        .reduce("", (a, b) -> a + b) + 
    ").*";
Pattern pattern = Pattern.compile(complexRegex);
```
- ะะปั ะบะฐะถะดะพะน ะฑัะบะฒั ัะพะทะดะฐะตััั character class `[ะฐะ]`, `[ะฒะ]` ะธ ั.ะด.
- Regex ั ะผะฝะพะถะตััะฒะตะฝะฝัะผะธ ะณััะฟะฟะฐะผะธ ะธ ะฐะปััะตัะฝะฐัะธัะผะธ
- ะัะธะฒะพะดะธั ะบ ะบะฐัะฐัััะพัะธัะตัะบะพะผั backtracking ะฝะฐ ะดะปะธะฝะฝัั ัััะพะบะฐั

## ะะฒัะพัั ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั

ะะพัััะฟะฝัะต ะฐะฒัะพัั ะดะปั ะฟะพะธัะบะฐ:
- ะขะพะปััะพะน ะ.ะ.
- ะะพััะพะตะฒัะบะธะน ะค.ะ.
- ะััะบะธะฝ ะ.ะก.
- ะงะตัะพะฒ ะ.ะ.
- ะัะปะณะฐะบะพะฒ ะ.ะ.
- ะขััะณะตะฝะตะฒ ะ.ะก.
- ะะพะณะพะปั ะ.ะ.
- ะะตัะผะพะฝัะพะฒ ะ.ะฎ.
- ะะพััะบะธะน ะ.
- ะจะพะปะพัะพะฒ ะ.ะ.

## ะะฒัะพั

**ะะธะผะธะฝ ะะตะพะฝะธะด** - lzimin05